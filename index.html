<!DOCTYPE html><html lang=es><script type=importmap>{"imports":{"3eBRw":"./web-ifc.98832ecb.wasm","czWhb":"./sw.js"}}</script><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0"><meta name=theme-color content=#0b1620><link rel=manifest href=manifest.webmanifest><link rel=apple-touch-icon href=icon-192.42634e61.png><title>Visor de Obra BIM</title><style>:root{color-scheme:dark;--bg-color:#050a0f;--panel-bg:#050a0fe6;--accent-color:#007bff;--text-color:#eef5ff;font-family:Segoe UI,system-ui,-apple-system,sans-serif}body{background:var(--bg-color);width:100vw;height:100vh;margin:0;overflow:hidden}#viewer-container{z-index:0;background:radial-gradient(circle at top,#0e1b2b 0%,#050a0f 55%);width:100%;height:100%;position:absolute;top:0;left:0}.ui-layer{pointer-events:none;z-index:10;flex-direction:column;justify-content:space-between;width:100%;height:100dvh;display:flex;position:absolute;top:0;left:0}.top-bar{pointer-events:none;justify-content:space-between;align-items:flex-start;padding:10px;display:flex}.panel-toggle{pointer-events:all;background:var(--panel-bg);color:#fff;cursor:pointer;backdrop-filter:blur(10px);border:1px solid #ffffff1a;border-radius:8px;align-items:center;gap:6px;padding:8px 12px;font-size:14px;display:flex}#badge-registros{pointer-events:all;color:#8fffd9;backdrop-filter:blur(4px);background:#00b36833;border-radius:20px;padding:8px 12px;font-size:13px;font-weight:700}.panel{pointer-events:all;background:var(--panel-bg);backdrop-filter:blur(16px);color:var(--text-color);border:1px solid #ffffff14;border-radius:16px;flex-direction:column;transition:transform .3s,opacity .3s;display:flex}.panel.hidden{opacity:0;pointer-events:none;transform:translate(-110%)}.panel.hidden-right{opacity:0;pointer-events:none;transform:translate(110%)}#structure-panel{z-index:20;gap:10px;width:300px;max-width:80vw;padding:16px;position:absolute;top:60px;bottom:100px;left:20px}#record-panel{z-index:20;gap:10px;width:300px;max-width:80vw;padding:16px;position:absolute;top:60px;right:20px}.controls{pointer-events:none;padding:20px;padding-bottom:max(20px,env(safe-area-inset-bottom));z-index:30;background:linear-gradient(#0000 0%,#050a0fcc 100%);flex-wrap:wrap;justify-content:center;gap:12px;display:flex}.btn{pointer-events:all;background:var(--accent-color);color:#fff;cursor:pointer;border:none;border-radius:50px;padding:12px 24px;font-size:15px;font-weight:600;box-shadow:0 4px 12px #0000004d}.btn-green{background:#00b368}.btn:disabled{color:#fff6;background:#304355}@media (width<=768px){#structure-panel,#record-panel{width:calc(100vw - 40px);max-height:60vh;inset:60px 20px auto}#record-panel{top:auto;bottom:100px}.controls{gap:8px;padding:10px}.btn{flex:1;min-width:auto;padding:10px 16px;font-size:13px}}input,textarea,button{font-family:inherit}input[type=search],input[type=date],textarea{color:#fff;box-sizing:border-box;background:#ffffff0d;border:1px solid #ffffff26;border-radius:8px;width:100%;padding:10px}#tree-container{border:1px solid #ffffff14;border-radius:8px;flex:1;padding:8px;overflow-y:auto}.tree-node-btn{text-align:left;color:#ddd;cursor:pointer;background:0 0;border:none;width:100%;padding:4px 8px}.tree-node-btn:hover{background:#ffffff1a;border-radius:4px}.tree-children{border-left:1px solid #ffffff1a;margin-left:12px}#btn-registrar{color:#fff;cursor:pointer;background:#00b368;border:none;border-radius:10px;width:100%;padding:12px;font-weight:700}</style><body>
    <div id=viewer-container></div>

    <div class=ui-layer>
        <div class=top-bar>
            <button class=panel-toggle id=toggle-tree>üå≥ √Årbol</button>
            <div id=badge-registros>0 registros</div>
            <button class=panel-toggle id=toggle-record>üìù Ficha</button>
        </div>

        <div id=structure-panel class="hidden panel">
            <div style=justify-content:space-between;align-items:center;margin-bottom:10px;display:flex>
                <strong>Estructura</strong>
                <button class=panel-toggle style="padding:4px 8px;font-size:12px" onclick="document.getElementById('structure-panel').classList.add('hidden')">‚úï</button>
            </div>
            <input type=search id=tree-search placeholder=Buscar...>
            <div id=tree-container>Carga un IFC...</div>
        </div>

        <div id=record-panel class="hidden-right panel">
            <div style=justify-content:space-between;align-items:center;margin-bottom:10px;display:flex>
                <strong>Registro</strong>
                <button class=panel-toggle style="padding:4px 8px;font-size:12px" onclick="document.getElementById('record-panel').classList.add('hidden-right')">‚úï</button>
            </div>
            <p id=selected-guid style="color:#aaa;margin:0 0 10px;font-size:12px">Selecciona un elemento</p>
            <label style=margin-bottom:8px;display:block>
                <span style=font-size:12px>Fecha</span>
                <input type=date id=input-fecha>
            </label>
            <label style=align-items:center;gap:8px;margin-bottom:8px;font-size:13px;display:flex>
                <input type=checkbox id=input-construido checked>
                Construido
            </label>
            <textarea id=input-comentario placeholder=Comentario... style=margin-bottom:10px></textarea>
            <button id=btn-registrar disabled>Guardar</button>
        </div>

        <div class=controls>
            <button class=btn id=btn-abrir>üìÇ Abrir</button>
            <button class="btn btn-outline" id=btn-home style=min-width:50px;padding:12px>üè†</button>
            <button class="btn btn-green" id=btn-descargar disabled>‚¨áÔ∏è CSV</button>
            <button class=btn id=btn-log style=display:none>Log</button>
        </div>
    </div>

    <input type=file id=file-input accept=.ifc,.txt,application/octet-stream style=display:none>
    <script type=module src=visor-obra.aeeb231a.js></script>
    <script>document.getElementById("toggle-tree").addEventListener("click",()=>{document.getElementById("structure-panel").classList.toggle("hidden")}),document.getElementById("toggle-record").addEventListener("click",()=>{document.getElementById("record-panel").classList.toggle("hidden-right")}),window.openRecordPanel=()=>{document.getElementById("record-panel").classList.remove("hidden-right")};</script>


